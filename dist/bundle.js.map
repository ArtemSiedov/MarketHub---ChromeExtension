{"version":3,"file":"bundle.js","mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;AChBA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAaA;AACA;;AAEA;AACA;AACA;AACA;AAYA;AACA;;AAEA;AACA;AACA;AACA;AAIA;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;AC3KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAsCA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;;;;;;;;;;;;;;;AC7LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvCA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;ACtJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://markethub---chromeextension-main/./content/hotkey.js","webpack://markethub---chromeextension-main/./content/modal.js","webpack://markethub---chromeextension-main/./content/pagination.js","webpack://markethub---chromeextension-main/./content/quick-open.js","webpack://markethub---chromeextension-main/./content/select-product.js","webpack://markethub---chromeextension-main/./content/storage.js","webpack://markethub---chromeextension-main/webpack/bootstrap","webpack://markethub---chromeextension-main/webpack/runtime/define property getters","webpack://markethub---chromeextension-main/webpack/runtime/hasOwnProperty shorthand","webpack://markethub---chromeextension-main/webpack/runtime/make namespace object","webpack://markethub---chromeextension-main/./content/main.js"],"sourcesContent":["export class Hotkey {\n  constructor(key) {\n    this.key = key;\n    this.enabled = true;\n  }\n  matches(e) {\n    return e.key === this.key;\n  }\n  setKey(key) {\n    this.key = key;\n  }\n  enable() {\n    this.enabled = true;\n  }\n  disable() {\n    this.enabled = false;\n  }\n} ","import { getSettings, setSettings } from './storage.js';\n\nexport class ModalManager {\n  constructor(options = {}) {\n    this.options = options;\n    this.overlay = null;\n    this.modal = null;\n  }\n\n  create() {\n    if (!document.body) {\n      alert('На этой странице расширения Chrome не работают!');\n      return;\n    }\n    if (document.getElementById('market-hub-modal-overlay')) return;\n\n    // Подключаем CSS только один раз\n    if (!document.getElementById('market-hub-modal-css')) {\n      const link = document.createElement('link');\n      link.id = 'market-hub-modal-css';\n      link.rel = 'stylesheet';\n      link.type = 'text/css';\n      link.href = chrome.runtime.getURL('content/market-hub-modal.css');\n      document.head.appendChild(link);\n    }\n\n    // Создаём overlay\n    const overlay = document.createElement('div');\n    overlay.id = 'market-hub-modal-overlay';\n    overlay.className = 'market-hub-modal-overlay';\n\n    // Создаём модальное окно\n    const modal = document.createElement('div');\n    modal.className = 'market-hub-modal';\n\n    // === БЛОК УПРАВЛЕНИЕ ===\n    const managementBlock = document.createElement('div');\n    managementBlock.className = 'market-hub-modal-block market-hub-modal-block-inline';\n    managementBlock.innerHTML = `\n      <div class=\"market-hub-modal-block-title\" style=\"font-size:16px; margin-bottom:14px;\">Управление</div>\n      <div class=\"market-hub-inline-row\">\n        <div class=\"market-hub-inline-block\">\n          <div class=\"market-hub-modal-block-title\">Открыть товары</div>\n          <input type=\"text\" id=\"hotkey-input\" class=\"market-hub-hotkey-input-inline\" placeholder=\"Клавиша...\" readonly>\n        </div>\n        <div class=\"market-hub-inline-block\">\n          <div class=\"market-hub-modal-block-title\">Выбор товара</div>\n          <input type=\"text\" id=\"select-product-hotkey-input\" class=\"market-hub-hotkey-input-inline\" placeholder=\"Клавиша...\" readonly>\n        </div>\n      </div>\n    `;\n    modal.appendChild(managementBlock);\n    // === КОНЕЦ БЛОКА УПРАВЛЕНИЕ ===\n\n    // === БЛОК НАВИГАЦИЯ ===\n    const navigationBlock = document.createElement('div');\n    navigationBlock.className = 'market-hub-modal-block market-hub-modal-block-inline';\n    navigationBlock.innerHTML = `\n      <div class=\"market-hub-modal-block-title\" style=\"font-size:16px; margin-bottom:14px;\">Навигация</div>\n      <div class=\"market-hub-inline-row\">\n        <div class=\"market-hub-inline-block\">\n          <div class=\"market-hub-modal-block-title\">Пагинация+</div>\n          <label class=\"market-hub-checkbox-label-inline\">\n            <input type=\"checkbox\" id=\"pagination-checkbox\" class=\"market-hub-checkbox\">\n            <span>Вкл.</span>\n          </label>\n        </div>\n      </div>\n    `;\n    modal.appendChild(navigationBlock);\n    // === КОНЕЦ БЛОКА НАВИГАЦИЯ ===\n\n    // Кнопки\n    const actions = document.createElement('div');\n    actions.className = 'market-hub-actions';\n    actions.innerHTML = `\n      <button class=\"market-hub-btn cancel\">Отмена</button>\n      <button class=\"market-hub-btn save\">Сохранить</button>\n    `;\n    modal.appendChild(actions);\n\n    overlay.appendChild(modal);\n    document.body.appendChild(overlay);\n    this.overlay = overlay;\n    this.modal = modal;\n\n    // === ПОСЛЕ добавления в DOM ищем элементы и вешаем обработчики ===\n    getSettings(['paginationPlus', 'quickOpenHotkey', 'selectProductHotkey']).then((result) => {\n      try {\n        const paginationCheckbox = document.getElementById('pagination-checkbox');\n        const hotkeyInput = document.getElementById('hotkey-input');\n        const selectProductHotkeyInput = document.getElementById('select-product-hotkey-input');\n        paginationCheckbox.checked = !!result.paginationPlus;\n        if (result.quickOpenHotkey) {\n          hotkeyInput.value = result.quickOpenHotkey;\n        }\n        if (result.selectProductHotkey) {\n          selectProductHotkeyInput.value = result.selectProductHotkey;\n        }\n      } catch (e) { console.error('MarketHub: ошибка при загрузке состояния', e); }\n    });\n\n    // Обработчик ввода хоткея для открытия товаров\n    const hotkeyInput = document.getElementById('hotkey-input');\n    hotkeyInput.addEventListener('keydown', (e) => {\n      e.preventDefault();\n      const keys = [];\n      if (e.ctrlKey) keys.push('Ctrl');\n      if (e.shiftKey) keys.push('Shift');\n      if (e.altKey) keys.push('Alt');\n      if (e.metaKey) keys.push('Meta');\n      if (!['Control', 'Shift', 'Alt', 'Meta'].includes(e.key)) {\n        keys.push(e.key.toUpperCase());\n      }\n      if (keys.length > 1) {\n        hotkeyInput.value = keys.join('+');\n      }\n    });\n\n    // Обработчик ввода хоткея для выбора товара\n    const selectProductHotkeyInput = document.getElementById('select-product-hotkey-input');\n    selectProductHotkeyInput.addEventListener('keydown', (e) => {\n      e.preventDefault();\n      selectProductHotkeyInput.value = e.key;\n    });\n\n    // Сохранить\n    const saveBtn = modal.querySelector('.market-hub-btn.save');\n    saveBtn.addEventListener('click', () => {\n      try {\n        const settings = {\n          paginationPlus: document.getElementById('pagination-checkbox').checked,\n          quickOpenHotkey: document.getElementById('hotkey-input').value,\n          selectProductHotkey: document.getElementById('select-product-hotkey-input').value\n        };\n        setSettings(settings).then(() => {\n          this.remove();\n          if (this.options.onSave) this.options.onSave(settings);\n        });\n      } catch (e) { console.error('MarketHub: ошибка при сохранении состояния', e); }\n    });\n\n    // Отмена\n    const cancelBtn = modal.querySelector('.market-hub-btn.cancel');\n    cancelBtn.addEventListener('click', () => {\n      try { this.remove(); } catch (e) { console.error('MarketHub: ошибка при закрытии модалки', e); }\n    });\n\n    // Клик вне модалки\n    overlay.addEventListener('click', (e) => {\n      try {\n        if (e.target === overlay) {\n          this.remove();\n        }\n      } catch (e) { console.error('MarketHub: ошибка при клике вне модалки', e); }\n    });\n  }\n\n  remove() {\n    if (this.overlay) {\n      this.overlay.remove();\n      this.overlay = null;\n      this.modal = null;\n    }\n  }\n\n  update(options = {}) {\n    this.options = { ...this.options, ...options };\n    // Перерисовать UI, если нужно\n  }\n\n  // Можно добавить методы для загрузки/сохранения настроек, обновления UI и т.д.\n} ","export function enhancePaginationIfEnabled() {\n  console.log('enhancePaginationIfEnabled called');\n  chrome.storage.local.get(['paginationPlus'], (result) => {\n    console.log('paginationPlus storage:', result);\n    if (!result.paginationPlus) return;\n    try {\n      const paginationContainer = document.querySelector('#sync-sources > ul, body > div:nth-child(2) > div:nth-child(1) > section > div:nth-child(16) > div > ul.pagination');\n      if (!paginationContainer) {\n        console.log('paginationContainer not found');\n        return;\n      }\n      console.log('paginationContainer found, adding UI');\n      // Получить количество товаров\n      const totalCountElem = document.querySelector('#items_summary_container > div.summary_container_content > div:nth-child(1) > strong.summary_total_count');\n      const pageSizeSelect = document.querySelector('#form_page_size > select');\n      let pageSize = 10;\n      if (pageSizeSelect) {\n        const selectedOption = pageSizeSelect.querySelector('option[selected]');\n        if (selectedOption) pageSize = parseInt(selectedOption.value, 10);\n        else if (pageSizeSelect.value) pageSize = parseInt(pageSizeSelect.value, 10);\n      }\n      let totalCount = 0;\n      if (totalCountElem) totalCount = parseInt(totalCountElem.textContent.replace(/\\D/g, ''), 10);\n      const lastPage = pageSize && totalCount ? Math.ceil(totalCount / pageSize) : null;\n      const liCount = paginationContainer.querySelectorAll('li').length;\n      console.log('lastPage:', lastPage, 'li count:', liCount);\n\n      // --- Кнопка первой страницы ---\n      let firstLi = paginationContainer.querySelector('.market-hub-first-page');\n      if (!firstLi && lastPage && liCount > 0) {\n        firstLi = document.createElement('li');\n        firstLi.className = 'market-hub-first-page';\n        const firstLinkBtn = document.createElement('a');\n        firstLinkBtn.href = '#';\n        firstLinkBtn.textContent = '«««';\n        firstLinkBtn.style.marginRight = '1px';\n        firstLinkBtn.addEventListener('click', (e) => {\n          e.preventDefault();\n          const firstLink = paginationContainer.querySelector('a[data-page]');\n          if (firstLink) {\n            let url = new URL(firstLink.href, window.location.origin);\n            url.searchParams.set('page', 1);\n            window.location.href = url.toString();\n          }\n        });\n        firstLi.appendChild(firstLinkBtn);\n        // Вставляем в начало списка\n        console.log('Добавляю первую страницу:', firstLi);\n        paginationContainer.insertBefore(firstLi, paginationContainer.firstChild);\n      }\n\n      // --- Кнопка последней страницы ---\n      let lastLi = paginationContainer.querySelector('.market-hub-last-page');\n      if (!lastLi && lastPage && liCount > 0) {\n        lastLi = document.createElement('li');\n        lastLi.className = 'market-hub-last-page';\n        const lastLink = document.createElement('a');\n        lastLink.href = '#';\n        lastLink.textContent = '»»»';\n        lastLink.style.marginLeft = '1px';\n        lastLink.addEventListener('click', (e) => {\n          e.preventDefault();\n          // Получаем актуальный pageSize и totalCount прямо перед переходом\n          const pageSizeSelect = document.querySelector('#form_page_size > select');\n          let pageSize = 10;\n          if (pageSizeSelect) {\n            const selectedOption = pageSizeSelect.querySelector('option[selected]');\n            if (selectedOption) pageSize = parseInt(selectedOption.value, 10);\n            else if (pageSizeSelect.value) pageSize = parseInt(pageSizeSelect.value, 10);\n          }\n          const totalCountElem = document.querySelector('#items_summary_container > div.summary_container_content > div:nth-child(1) > strong.summary_total_count');\n          let totalCount = 0;\n          if (totalCountElem) totalCount = parseInt(totalCountElem.textContent.replace(/\\D/g, ''), 10);\n          const lastPage = pageSize && totalCount ? Math.ceil(totalCount / pageSize) : 1;\n          // Берём первую ссылку для baseUrl, но page подставляем вручную\n          const firstLink = paginationContainer.querySelector('a[data-page]');\n          if (firstLink) {\n            let url = new URL(firstLink.href, window.location.origin);\n            url.searchParams.set('page', lastPage);\n            window.location.href = url.toString();\n          }\n        });\n        lastLi.appendChild(lastLink);\n        console.log('Добавляю последнюю страницу:', lastLi);\n        paginationContainer.appendChild(lastLi);\n      }\n\n      // --- Бокс для ввода номера страницы ---\n      let gotoLi = paginationContainer.querySelector('.market-hub-goto-page');\n      let gotoInput, hintDiv;\n      if (!gotoLi) {\n        gotoLi = document.createElement('li');\n        gotoLi.className = 'market-hub-goto-page';\n        // Только input, без кнопки\n        gotoInput = document.createElement('input');\n        gotoInput.type = 'number';\n        gotoInput.min = 1;\n        gotoInput.max = lastPage || 9999;\n        gotoInput.placeholder = '№';\n        gotoInput.style.width = '72px';\n        gotoInput.style.height = '35px';\n        gotoInput.style.padding = '0 6px';\n        gotoInput.style.borderRadius = '4px';\n        gotoInput.style.border = '1px solid #ccc';\n        gotoInput.style.fontSize = '16px';\n        gotoInput.style.textAlign = 'center';\n        gotoInput.style.margin = '0 4px';\n        gotoInput.style.boxSizing = 'border-box';\n        gotoInput.addEventListener('input', () => {\n          gotoInput.style.borderColor = '#ccc';\n          if (hintDiv) hintDiv.style.display = 'none';\n        });\n        // Подсказка\n        hintDiv = document.createElement('div');\n        hintDiv.style.display = 'none';\n        hintDiv.style.position = 'absolute';\n        hintDiv.style.background = '#fff';\n        hintDiv.style.color = '#d32f2f';\n        hintDiv.style.fontSize = '13px';\n        hintDiv.style.padding = '2px 8px';\n        hintDiv.style.borderRadius = '4px';\n        hintDiv.style.boxShadow = '0 2px 8px rgba(60,60,120,0.08)';\n        hintDiv.style.width = '';\n        hintDiv.style.minWidth = '0';\n        hintDiv.style.maxWidth = '100vw';\n        hintDiv.style.margin = '6px auto 0 auto';\n        hintDiv.textContent = '';\n        gotoLi.style.position = 'relative';\n        // Переход по Enter или blur\n        function goToPage() {\n          const val = parseInt(gotoInput.value, 10);\n          if (!val || !lastPage || val < 1 || val > lastPage) {\n            gotoInput.style.borderColor = 'red';\n            hintDiv.textContent = `Всего страниц: ${lastPage}`;\n            hintDiv.style.display = 'block';\n            return;\n          }\n          hintDiv.style.display = 'none';\n          const firstLink = paginationContainer.querySelector('a[data-page]');\n          if (firstLink) {\n            let url = new URL(firstLink.href, window.location.origin);\n            url.searchParams.set('page', val);\n            window.location.href = url.toString();\n          }\n        }\n        gotoInput.addEventListener('keydown', (e) => {\n          if (e.key === 'Enter') {\n            goToPage();\n          }\n        });\n        gotoInput.addEventListener('blur', goToPage);\n        gotoLi.appendChild(gotoInput);\n        gotoLi.appendChild(hintDiv);\n        console.log('Добавляю input для перехода:', gotoLi);\n        paginationContainer.appendChild(gotoLi);\n      } else {\n        gotoInput = gotoLi.querySelector('input[type=\"number\"]');\n        hintDiv = gotoLi.querySelector('div');\n        if (gotoInput) {\n          gotoInput.max = lastPage || 9999;\n        }\n      }\n    } catch (e) { console.error('MarketHub: ошибка в enhancePaginationIfEnabled (внутренняя)', e); }\n  });\n}\n\nexport function observePaginationPlus() {\n  document.addEventListener('change', (e) => {\n    if (e.target && e.target.id === 'pagination-checkbox') {\n      setTimeout(enhancePaginationIfEnabled, 100);\n    }\n    if (e.target && e.target.closest('#form_page_size')) {\n      setTimeout(enhancePaginationIfEnabled, 200);\n    }\n  });\n  window.addEventListener('DOMContentLoaded', enhancePaginationIfEnabled);\n  window.addEventListener('popstate', enhancePaginationIfEnabled);\n}\n\nexport function observePaginationContainer() {\n  const observer = new MutationObserver(() => {\n    enhancePaginationIfEnabled();\n  });\n  observer.observe(document.body, { childList: true, subtree: true });\n}\n\nexport function initPagination() {\n  observePaginationContainer();\n  observePaginationPlus();\n} ","export function setupQuickOpenProducts() {\n  console.log('setupQuickOpenProducts called');\n  chrome.storage.local.get(['quickOpenHotkey'], (result) => {\n    console.log('quickOpen storage:', result);\n    if (!result.quickOpenHotkey) {\n      document.removeEventListener('keydown', handleQuickOpenHotkey);\n      return;\n    }\n    function handleQuickOpenHotkey(e) {\n      const keys = [];\n      if (e.ctrlKey) keys.push('Ctrl');\n      if (e.shiftKey) keys.push('Shift');\n      if (e.altKey) keys.push('Alt');\n      if (e.metaKey) keys.push('Meta');\n      keys.push(e.key.toUpperCase());\n      if (keys.join('+') === result.quickOpenHotkey) {\n        e.preventDefault();\n        openAllProducts();\n      }\n    }\n    document.removeEventListener('keydown', handleQuickOpenHotkey);\n    document.addEventListener('keydown', handleQuickOpenHotkey);\n  });\n}\n\nexport function openAllProducts() {\n  try {\n    const productCells = document.querySelectorAll(\"#sync-sources-container > table > tbody > tr > td:nth-child(3) > div > a\");\n    if (productCells.length === 0) {\n      console.log('MarketHub: товары не найдены на странице');\n      return;\n    }\n    console.log(`MarketHub: найдено ${productCells.length} товаров, открываем...`);\n    productCells.forEach((cell) => {\n      window.open(cell.href, '_blank');\n    });\n  } catch (e) {\n    console.error('MarketHub: ошибка при открытии товаров', e);\n  }\n} ","import { Hotkey } from './hotkey.js';\n\nlet selectProductHotkeyPressed = false;\nlet selectProductHotkey = null;\n\nexport function setupSelectProductHotkey() {\n  console.log('setupSelectProductHotkey called');\n  try {\n    chrome.storage.local.get(['selectProductHotkey'], (result) => {\n      console.log('selectProductHotkey storage:', result);\n      try {\n        if (!result.selectProductHotkey) {\n          if (window.marketHubSelectProductHotkeyKeyHandler) {\n            document.removeEventListener('keydown', window.marketHubSelectProductHotkeyKeyHandler);\n            document.removeEventListener('keyup', window.marketHubSelectProductHotkeyKeyHandler);\n            window.marketHubSelectProductHotkeyKeyHandler = null;\n          }\n          if (window.marketHubSelectProductHotkeyMouseHandler) {\n            document.removeEventListener('mousedown', window.marketHubSelectProductHotkeyMouseHandler);\n            window.marketHubSelectProductHotkeyMouseHandler = null;\n          }\n          return;\n        }\n        selectProductHotkey = result.selectProductHotkey;\n\n        // Клавиша\n        window.marketHubSelectProductHotkeyKeyHandler = (e) => {\n          if (e.key && e.key === selectProductHotkey) {\n            if (e.type === 'keydown') selectProductHotkeyPressed = true;\n            if (e.type === 'keyup') selectProductHotkeyPressed = false;\n          }\n        };\n        document.addEventListener('keydown', window.marketHubSelectProductHotkeyKeyHandler);\n        document.addEventListener('keyup', window.marketHubSelectProductHotkeyKeyHandler);\n\n        // Клик мышкой по строке товара\n        window.marketHubSelectProductHotkeyMouseHandler = (e) => {\n          // Разрешаем выбор только если зажата клавиша\n          if (!selectProductHotkeyPressed) return;\n          const tr = e.target.closest('tr.kv-expand-detail-row.info.skip-export');\n          if (tr) {\n            e.preventDefault();\n            const dataKey = tr.getAttribute('data-key');\n            // Пробуем найти чекбокс внутри строки\n            let checkbox = tr.querySelector('input[type=\"checkbox\"]');\n            // Если не нашли, ищем по data-key в строке sync-sources\n            if (!checkbox && dataKey) {\n              checkbox = document.querySelector(\n                `tr.sync-sources[data-key=\"${dataKey}\"] input[type=\"checkbox\"]`\n              );\n            }\n            if (checkbox) checkbox.click();\n          }\n        };\n        document.addEventListener('mousedown', window.marketHubSelectProductHotkeyMouseHandler, true);\n      } catch (e) { console.error('MarketHub: ошибка в setupSelectProductHotkey (внутренняя)', e); }\n    });\n  } catch (e) {\n    console.error('MarketHub: ошибка в setupSelectProductHotkey', e);\n  }\n}\n\nexport class SelectProductHotkey extends Hotkey {\n  constructor(key) {\n    super(key);\n    this.pressed = false;\n    this._keyHandler = this._handleKey.bind(this);\n    this._mouseHandler = this._handleMouse.bind(this);\n  }\n\n  _handleKey(e) {\n    if (e.key === this.key) {\n      this.pressed = e.type === 'keydown';\n    }\n  }\n\n  _handleMouse(e) {\n    if (!this.enabled) return;\n    if (this.pressed) {\n      // Реальная логика выбора товара по клику\n      const tr = e.target.closest('tr.kv-expand-detail-row.info.skip-export');\n      if (tr) {\n        e.preventDefault();\n        const dataKey = tr.getAttribute('data-key');\n        // Пробуем найти чекбокс внутри строки\n        let checkbox = tr.querySelector('input[type=\"checkbox\"]');\n        // Если не нашли, ищем по data-key в строке sync-sources\n        if (!checkbox && dataKey) {\n          checkbox = document.querySelector(\n            `tr.sync-sources[data-key=\"${dataKey}\"] input[type=\"checkbox\"]`\n          );\n        }\n        if (checkbox) checkbox.click();\n      }\n    }\n  }\n\n  listen() {\n    document.addEventListener('keydown', this._keyHandler);\n    document.addEventListener('keyup', this._keyHandler);\n    document.addEventListener('mousedown', this._mouseHandler);\n  }\n\n  unlisten() {\n    document.removeEventListener('keydown', this._keyHandler);\n    document.removeEventListener('keyup', this._keyHandler);\n    document.removeEventListener('mousedown', this._mouseHandler);\n  }\n\n  static setupFromStorage() {\n    chrome.storage.local.get(['selectProductHotkeyEnabled', 'selectProductHotkey'], (result) => {\n      if (!result.selectProductHotkeyEnabled || !result.selectProductHotkey) {\n        if (window.marketHubSelectProductHotkeyKeyHandler) {\n          document.removeEventListener('keydown', window.marketHubSelectProductHotkeyKeyHandler);\n          document.removeEventListener('keyup', window.marketHubSelectProductHotkeyKeyHandler);\n          window.marketHubSelectProductHotkeyKeyHandler = null;\n        }\n        if (window.marketHubSelectProductHotkeyMouseHandler) {\n          document.removeEventListener('mousedown', window.marketHubSelectProductHotkeyMouseHandler);\n          window.marketHubSelectProductHotkeyMouseHandler = null;\n        }\n        return;\n      }\n      const selectProductHotkey = result.selectProductHotkey;\n      let selectProductHotkeyPressed = false;\n      window.marketHubSelectProductHotkeyKeyHandler = (e) => {\n        if (e.key && e.key === selectProductHotkey) {\n          if (e.type === 'keydown') selectProductHotkeyPressed = true;\n          if (e.type === 'keyup') selectProductHotkeyPressed = false;\n        }\n      };\n      document.addEventListener('keydown', window.marketHubSelectProductHotkeyKeyHandler);\n      document.addEventListener('keyup', window.marketHubSelectProductHotkeyKeyHandler);\n      window.marketHubSelectProductHotkeyMouseHandler = (e) => {\n        if (!selectProductHotkeyPressed) return;\n        const tr = e.target.closest('tr.kv-expand-detail-row.info.skip-export');\n        if (tr) {\n          e.preventDefault();\n          const dataKey = tr.getAttribute('data-key');\n          let checkbox = tr.querySelector('input[type=\"checkbox\"]');\n          if (!checkbox && dataKey) {\n            checkbox = document.querySelector(\n              `tr.sync-sources[data-key=\"${dataKey}\"] input[type=\"checkbox\"]`\n            );\n          }\n          if (checkbox) checkbox.click();\n        }\n      };\n      document.addEventListener('mousedown', window.marketHubSelectProductHotkeyMouseHandler);\n    });\n  }\n} ","export function getSettings(keys) {\n  return new Promise((resolve, reject) => {\n    try {\n      chrome.storage.local.get(keys, (result) => {\n        if (chrome.runtime.lastError) {\n          reject(chrome.runtime.lastError);\n        } else {\n          resolve(result);\n        }\n      });\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n\nexport function setSettings(settings) {\n  return new Promise((resolve, reject) => {\n    try {\n      chrome.storage.local.set(settings, () => {\n        if (chrome.runtime.lastError) {\n          reject(chrome.runtime.lastError);\n        } else {\n          resolve();\n        }\n      });\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n\nexport function onSettingsChanged(listener) {\n  chrome.storage.onChanged.addListener((changes, area) => {\n    if (area === 'local') {\n      listener(changes);\n    }\n  });\n} ","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","console.log('MARKETHUB BUNDLE LOADED');\nimport { setupQuickOpenProducts } from './quick-open.js';\nimport { enhancePaginationIfEnabled, observePaginationPlus, observePaginationContainer } from './pagination.js';\nimport { ModalManager } from './modal.js';\nimport { setupSelectProductHotkey } from './select-product.js';\n\nfunction reinitAll() {\n  setupQuickOpenProducts();\n  enhancePaginationIfEnabled();\n  setupSelectProductHotkey();\n}\n\n// Инициализация при старте\nsetupQuickOpenProducts();\nenhancePaginationIfEnabled();\nobservePaginationPlus();\nobservePaginationContainer();\nsetupSelectProductHotkey();\n\nconst modalManager = new ModalManager({\n  onSave: () => {\n    reinitAll();\n  }\n});\n\n// --- Логика открытия всех товаров ---\nfunction openAllProducts() {\n  // Ваша логика открытия всех товаров\n  console.log('Открыть все товары!');\n}\n\n// --- Логика выбора товара по клику ---\nfunction selectProductByClick(e) {\n  // Ваша логика выбора товара по клику\n  console.log('Выбрать товар по клику!', e);\n}\n\n// --- Инициализация пагинации ---\n// const paginationManager = new PaginationManager();\n// paginationManager.enable(); // включить при необходимости\n\n// Глобальный обработчик сообщений для открытия/закрытия модалки\nchrome.runtime.onMessage.addListener((msg, sender, sendResponse) => {\n  if (msg && msg.type === 'open_market_hub_modal') {\n    modalManager.create();\n  }\n  if (msg && msg.type === 'close_market_hub_modal') {\n    modalManager.remove();\n  }\n}); "],"names":[],"sourceRoot":""}